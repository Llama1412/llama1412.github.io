const baseMarkersDebug=!1;let airbaseIconGroup=L.layerGroup(),airbaseIcon=L.Icon.extend({options:{iconSize:[25,40],iconAnchor:[12,39],popupAnchor:[0,-41]}});const hoursZulu=(new Date).getUTCHours(),minutesZulu=(new Date).getUTCMinutes();let atisInformation={},currentAtisPlaying,airbaseIconBlue=new airbaseIcon({iconUrl:"images/icons/airport-icon-blue.png"}),airbaseIconRed=new airbaseIcon({iconUrl:"images/icons/airport-icon-red.png"}),airbaseIconNeutral=new airbaseIcon({iconUrl:"images/icons/airport-icon-neutral.png"}),airbaseIconUnknown=new airbaseIcon({iconUrl:"images/icons/airport-icon-unknown.png"});function getAtisCode(){const currentTime=serverStats.uptime;switch(!0){case currentTime<1e3:return"Alpha";case currentTime<2e3:return"Bravo";case currentTime<3e3:return"Charlie";case currentTime<4e3:return"Delta";case currentTime<5e3:return"Echo";case currentTime<6e3:return"Foxtrot";case currentTime<7e3:return"Gulf";case currentTime<8e3:return"Hotel";case currentTime<9e3:return"India";case currentTime<1e4:return"Juliet";case currentTime<11e3:return"Kilo";case currentTime<12e3:return"Lima";case currentTime<13e3:return"Mike";case currentTime<14e3:return"November";case currentTime<15e3:return"Oscur";case currentTime<16e3:return"Papa";case currentTime<17e3:return"Quebec";case currentTime<18e3:return"Romeo";case currentTime<19e3:return"Seirra";case currentTime<2e4:return"Tango";case currentTime<21e3:return"Uniform"}}function getBase(){let base=Math.trunc(3.28084*serverStats.weather.clouds.base),base1,base2,base3;return`${(base=(base-base%500)/100).toString().substring(0,1)} ${base.toString().substring(1,2)} ${base.toString().substring(2,3)}`}function getVisibility(){const visibility=serverStats.weather.fog.visibility;switch(!0){case visibility<1:return"10 kilometers or more";case visibility<2:return"5 kilometers or less";case visibility>3:return"Low"}}function getCeiling(){const ceilingBase=serverStats.weather.clouds.density;switch(!0){case ceilingBase<2:return"Clear";case ceilingBase<5:return"Few";case ceilingBase<7:return"Broken";case ceilingBase<8:case ceilingBase>=8:return"Overcast"}}function getRunway(id){let windDirection=serverStats.weather.wind.atGround.dir;switch(id){case 5000002:case 5000006:case 5000012:case 5000008:if(windDirection>=0&&windDirection<=180)return"0 4";if(windDirection>=181&&windDirection<=360)return"2 2";break;case 5000016:if(windDirection>=0&&windDirection<=180)return"0 5 Left, 0 5 Right";if(windDirection>=181&&windDirection<=360)return"2 3 Left, 2 3 Right";break;case 5000004:if(windDirection>=0&&windDirection<=180)return"0 9";if(windDirection>=181&&windDirection<=360)return"2 7";break;case 5000010:if(windDirection>=0&&windDirection<=180)return"0 4";if(windDirection>=181&&windDirection<=360)return"2 2"}}function endAtisReadback(){atisReadback(currentAtisPlaying)}function atisReadback(id){if(currentAtisPlaying=id,responsiveVoice.voiceSupport())if(responsiveVoice.isPlaying())responsiveVoice.cancel();else switch(id){case 5000002:currentAtisPlaying=id,responsiveVoice.speak(`${atisInformation[id].name} Airbase Information ${getAtisCode()}, ${hoursZulu} ${minutesZulu} zulu, Wind ${serverStats.weather.wind.atGround.dir.toString().substring(0,1)} ${serverStats.weather.wind.atGround.dir.toString().substring(2,1)} ${serverStats.weather.wind.atGround.dir.toString().substring(2)} at ${serverStats.weather.wind.atGround.speed}, Visibility at ground ${getVisibility()}, Ceiling ${getCeiling()}, Base ${getBase()}, Tempature ${serverStats.weather.season.temperature} degrees celsius, Altimeter ${atisInformation[id].qnh}, Visual Approach runway ${getRunway(5000002)} in use, Departing runway ${getRunway(5000002)}, Announce on taxi and takeoff, read back all ATC instructions, Ground tune channel, 2 4 9 decimal 500 on SRS. Advise on initial contact, you have information ${getAtisCode()}.`,"UK English Female",{rate:.9,onend:endAtisReadback});break;case 5000006:responsiveVoice.speak(`${atisInformation[id].name} Airbase Information ${getAtisCode()}, ${hoursZulu} ${minutesZulu} zulu, Wind ${serverStats.weather.wind.atGround.dir.toString().substring(0,1)} ${serverStats.weather.wind.atGround.dir.toString().substring(2,1)} ${serverStats.weather.wind.atGround.dir.toString().substring(2)} at ${serverStats.weather.wind.atGround.speed}, Visibility at ground ${getVisibility()}, Ceiling ${getCeiling()}, Base ${getBase()}, Tempature ${serverStats.weather.season.temperature} degrees celsius, Altimeter ${atisInformation[id].qnh}, Visual Approach runway ${getRunway(5000006)} in use, Departing runway ${getRunway(5000006)}, Announce on taxi and takeoff, read back all ATC instructions, Ground tune channel, 2 4 9 decimal 500 on SRS. Advise on initial contact, you have information ${getAtisCode()}.`,"UK English Male",{rate:.9,onend:endAtisReadback});break;case 5000012:responsiveVoice.speak(`${atisInformation[id].name} Airbase Information ${getAtisCode()}, ${hoursZulu} ${minutesZulu} zulu, Wind ${serverStats.weather.wind.atGround.dir.toString().substring(0,1)} ${serverStats.weather.wind.atGround.dir.toString().substring(2,1)} ${serverStats.weather.wind.atGround.dir.toString().substring(2)} at ${serverStats.weather.wind.atGround.speed}, Visibility at ground ${getVisibility()}, Ceiling ${getCeiling()}, Base ${getBase()}, Tempature ${serverStats.weather.season.temperature} degrees celsius, Altimeter ${atisInformation[id].qnh}, Visual Approach runway ${getRunway(5000012)} in use, Departing runway ${getRunway(5000012)}, Announce on taxi and takeoff, read back all ATC instructions, Ground tune channel, 2 4 9 decimal 500 on SRS. Advise on initial contact, you have information ${getAtisCode()}.`,"US English Female",{rate:.9,onend:endAtisReadback});break;case 5000008:responsiveVoice.speak(`${atisInformation[id].name} Airbase Information ${getAtisCode()}, ${hoursZulu} ${minutesZulu} zulu, Wind ${serverStats.weather.wind.atGround.dir.toString().substring(0,1)} ${serverStats.weather.wind.atGround.dir.toString().substring(2,1)} ${serverStats.weather.wind.atGround.dir.toString().substring(2)} at ${serverStats.weather.wind.atGround.speed}, Visibility at ground ${getVisibility()}, Ceiling ${getCeiling()}, Base ${getBase()}, Tempature ${serverStats.weather.season.temperature} degrees celsius, Altimeter ${atisInformation[id].qnh}, Visual Approach runway ${getRunway(5000008)} in use, Departing runway ${getRunway(5000008)}, Announce on taxi and takeoff, read back all ATC instructions, Ground tune channel, 2 4 9 decimal 500 on SRS. Advise on initial contact, you have information ${getAtisCode()}.`,"US English Male",{rate:.9,onend:endAtisReadback});break;case 5000016:responsiveVoice.speak(`${atisInformation[id].name} Airbase Information ${getAtisCode()}, ${hoursZulu} ${minutesZulu} zulu, Wind ${serverStats.weather.wind.atGround.dir.toString().substring(0,1)} ${serverStats.weather.wind.atGround.dir.toString().substring(2,1)} ${serverStats.weather.wind.atGround.dir.toString().substring(2)} at ${serverStats.weather.wind.atGround.speed}, Visibility at ground ${getVisibility()}, Ceiling ${getCeiling()}, Base ${getBase()}, Tempature ${serverStats.weather.season.temperature} degrees celsius, Altimeter ${atisInformation[id].qnh}, Visual Approach runway ${getRunway(5000016)} in use, Departing runway ${getRunway(5000016)}, Announce on taxi and takeoff, read back all ATC instructions, Ground tune channel, 2 4 9 decimal 500 on SRS. Advise on initial contact, you have information ${getAtisCode()}.`,"UK English Male",{rate:.9,onend:endAtisReadback});break;case 5000004:responsiveVoice.speak(`${atisInformation[id].name} Airbase Information ${getAtisCode()}, ${hoursZulu} ${minutesZulu} zulu, Wind ${serverStats.weather.wind.atGround.dir.toString().substring(0,1)} ${serverStats.weather.wind.atGround.dir.toString().substring(2,1)} ${serverStats.weather.wind.atGround.dir.toString().substring(2)} at ${serverStats.weather.wind.atGround.speed}, Visibility at ground ${getVisibility()}, Ceiling ${getCeiling()}, Base ${getBase()}, Tempature ${serverStats.weather.season.temperature} degrees celsius, Altimeter ${atisInformation[id].qnh}, Visual Approach runway ${getRunway(5000004)} in use, Departing runway ${getRunway(5000004)}, Announce on taxi and takeoff, read back all ATC instructions, Ground tune channel, 2 4 9 decimal 500 on SRS. Advise on initial contact, you have information ${getAtisCode()}.`,"US English Female",{rate:.9,onend:endAtisReadback});break;case 5000010:responsiveVoice.speak(`${atisInformation[id].name} Airbase Information ${getAtisCode()}, ${hoursZulu} ${minutesZulu} zulu, Wind ${serverStats.weather.wind.atGround.dir.toString().substring(0,1)} ${serverStats.weather.wind.atGround.dir.toString().substring(2,1)} ${serverStats.weather.wind.atGround.dir.toString().substring(2)} at ${serverStats.weather.wind.atGround.speed}, Visibility at ground ${getVisibility()}, Ceiling ${getCeiling()}, Base ${getBase()}, Tempature ${serverStats.weather.season.temperature} degrees celsius, Altimeter ${atisInformation[id].qnh}, Visual Approach runway ${getRunway(5000010)} in use, Departing runway ${getRunway(5000010)}, Announce on taxi and takeoff, read back all ATC instructions, Ground tune channel, 2 4 9 decimal 500 on SRS. Advise on initial contact, you have information ${getAtisCode()}.`,"UK English Male",{rate:.9,onend:endAtisReadback})}}function updateAirbaseIcons(data){for(x in(globalDebug||baseMarkersDebug)&&console.log("DEBUG - updateAirbaseIcons() - Updating Airbase Markers..."),data.airports)if("woRunWay"!==data.airports[x].Name){let mapIconLat=data.airports[x].LatLongAlt.Lat,mapIconLong=data.airports[x].LatLongAlt.Long,unitType,unitCoalition,qnh=serverStats.weather.qnh/25.399999704976+data.airports[x].LatLongAlt.Alt/900,customPopup,customOptions;if(unitType=5===data.airports[x].Type.level1&&13===data.airports[x].Type.level2?"Airfield":"Not Defined",unitCoalition=2===data.airports[x].CoalitionID?"Blue":1===data.airports[x].CoalitionID?"Red":3===data.airports[x].CoalitionID&&theater_objectives.includes(data.airports[x].Name)?"Neutral":"Unknown",theater_objectives.includes(data.airports[x].Name)?(customPopup='<table class="pixel-popup-table"><tr><td><strong>Name:</strong></td><td class="right">'+data.airports[x].Name+'</td></tr><tr><td><strong>Type:</strong></td><td class="right">'+unitType+'</td></tr></tr><tr><td><strong>Controlled:</strong></td><td class="right">'+unitCoalition+'</td></tr><tr><td><strong>Altitude:</strong></td><td class="right">'+Math.trunc(3.28*data.airports[x].LatLongAlt.Alt)+' FT</td></tr><tr><td><strong>Airfield QNH:</strong></td><td class="right">'+qnh.toFixed(2)+'</td></tr><tr><td><strong>ATIS:</strong></td><td class="right"><input id="'+data.airports[x].id+'" class="pixel-button-atis" onclick="atisReadback('+data.airports[x].id+')" type="button" value="Play/Stop" /></td></tr></table>',customOptions={maxWidth:500,className:"pixel-custom-popup"}):(customPopup='<table class="pixel-popup-table"><tr><td><strong>Name:</strong></td><td class="right">'+data.airports[x].Name+'</td></tr><tr><td><strong>Type:</strong></td><td class="right">'+unitType+'</td></tr></tr><tr><td><strong>Controlled:</strong></td><td class="right">'+unitCoalition+'</td></tr><tr><td><strong>Altitude:</strong></td><td class="right">'+Math.trunc(3.28*data.airports[x].LatLongAlt.Alt)+' FT</td></tr><tr><td><strong>Airfield QNH:</strong></td><td class="right">'+qnh.toFixed(2)+"</td></tr></table>",customOptions={maxWidth:500,className:"pixel-custom-popup"}),atisInformation[data.airports[x].id]={},atisInformation[data.airports[x].id].name=data.airports[x].Name,atisInformation[data.airports[x].id].thickness=data.weather.clouds.thickness,atisInformation[data.airports[x].id].density=data.weather.clouds.density,atisInformation[data.airports[x].id].base=data.weather.clouds.base,atisInformation[data.airports[x].id].precipitation=data.weather.clouds.iprecptns,atisInformation[data.airports[x].id].qnh=qnh.toFixed(2),2===data.airports[x].CoalitionID){let airbaseMarker=L.marker([mapIconLat,mapIconLong],{icon:airbaseIconBlue}).bindPopup(customPopup,customOptions);airbaseMarker._leaflet_id=data.airports[x].id,airbaseIconGroup.getLayer(data.airports[x].id)?((globalDebug||baseMarkersDebug)&&console.log("DEBUG - updateAirbaseIcons() - "+`Marker ${data.airports[x].id} already found in airbaseIconGroup - Updating`),airbaseIconGroup.getLayer(data.airports[x].id).setIcon(airbaseIconBlue),airbaseIconGroup.getLayer(data.airports[x].id)._popup.setContent(customPopup)):((globalDebug||baseMarkersDebug)&&console.log("DEBUG - updateAirbaseIcons() - "+`Marker ${data.airports[x].id} Created - New Icon`),airbaseIconGroup.addLayer(airbaseMarker),airbaseMarker.setZIndexOffset(-2e3),airbaseMarker.addTo(map))}else if(1===data.airports[x].CoalitionID){let airbaseMarker=L.marker([mapIconLat,mapIconLong],{icon:airbaseIconRed}).bindPopup(customPopup,customOptions);airbaseMarker._leaflet_id=data.airports[x].id,airbaseIconGroup.getLayer(data.airports[x].id)?((globalDebug||baseMarkersDebug)&&console.log("DEBUG - updateAirbaseIcons() - "+`Marker ${data.airports[x].id} already found in airbaseIconGroup - Updating`),airbaseIconGroup.getLayer(data.airports[x].id).setIcon(airbaseIconRed),airbaseIconGroup.getLayer(data.airports[x].id)._popup.setContent(customPopup)):((globalDebug||baseMarkersDebug)&&console.log("DEBUG - updateAirbaseIcons() - "+`Marker ${data.airports[x].id} Created - New Icon`),airbaseIconGroup.addLayer(airbaseMarker),airbaseMarker.setZIndexOffset(-2e3),airbaseMarker.addTo(map))}else if(3===data.airports[x].CoalitionID&&theater_objectives.includes(data.airports[x].Name)){let airbaseMarker=L.marker([mapIconLat,mapIconLong],{icon:airbaseIconNeutral}).bindPopup(customPopup,customOptions);airbaseMarker._leaflet_id=data.airports[x].id,airbaseIconGroup.getLayer(data.airports[x].id)?((globalDebug||baseMarkersDebug)&&console.log("DEBUG - updateAirbaseIcons() - "+`Marker ${data.airports[x].id} already found in airbaseIconGroup - Updating`),airbaseIconGroup.getLayer(data.airports[x].id).setIcon(airbaseIconNeutral),airbaseIconGroup.getLayer(data.airports[x].id)._popup.setContent(customPopup)):((globalDebug||baseMarkersDebug)&&console.log("DEBUG - updateAirbaseIcons() - "+`Marker ${data.airports[x].id} Created - New Icon`),airbaseIconGroup.addLayer(airbaseMarker),airbaseMarker.setZIndexOffset(-2e3),airbaseMarker.addTo(map))}else{let airbaseMarker=L.marker([mapIconLat,mapIconLong],{icon:airbaseIconUnknown}).bindPopup(customPopup,customOptions);airbaseMarker._leaflet_id=data.airports[x].id,airbaseIconGroup.getLayer(data.airports[x].id)?((globalDebug||baseMarkersDebug)&&console.log("DEBUG - updateAirbaseIcons() - "+`Marker ${data.airports[x].id} already found in airbaseIconGroup - Updating`),airbaseIconGroup.getLayer(data.airports[x].id).setIcon(airbaseIconUnknown),airbaseIconGroup.getLayer(data.airports[x].id)._popup.setContent(customPopup)):((globalDebug||baseMarkersDebug)&&console.log("DEBUG - updateAirbaseIcons() - "+`Marker ${data.airports[x].id} Created - New Icon`),airbaseIconGroup.addLayer(airbaseMarker),airbaseMarker.setZIndexOffset(-2e3),airbaseMarker.addTo(map))}}}